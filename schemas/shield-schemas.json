{
  "common": {
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "title": "Shield Common Format Payload Schema.",
    "description": "Common fields for all Shield-Study doc_types.",
    "properties": {
      "version": {
        "type": "integer",
        "title": "Version schema.  Will be 3",
        "enum": [
          3
        ]
      },
      "study_name": {
        "type": "string",
        "minLength": 1,
        "description": "Name of a particular study.  Usually the addon_id."
      },
      "branch": {
        "type": "string",
        "minLength": 1,
        "description": "Which branch (variation) of the study the user has."
      },
      "addon_version": {
        "type": "string",
        "minLength": 1,
        "description": "Semantic version of the addon."
      },
      "shield_version": {
        "type": "string",
        "minLength": 1,
        "description": "Which version of the shield-studies-addon-utils."
      },
      "data": {
        "type": "object",
        "description": "Data must conform to one of the 3 validators below.",
        "properties": {}
      }
    },
    "required": [
      "version",
      "study_name",
      "branch",
      "addon_version",
      "shield_version",
      "data"
    ]
  },
  "shield-study-data": {
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "description": "Shield Study State",
    "properties": {
      "study_state": {
        "type": "string",
        "description": "message about the most recent state of the study.",
        "enum": [
          "enter",
          "exit",
          "installed",
          "ineligible",
          "expired",
          "user-disable",
          "ended-positive",
          "ended-neutral",
          "ended-negative",
          "active"
        ]
      },
      "study_state_fullname": {
        "type": "string",
        "description": "Second part of name of state, if any.  Study-specific for study-defined endings."
      },
      "attributes": {
        "type": "object",
        "description": "Map(string, string) of attributes about the state, if needed.",
        "properties": {},
        "additionalProperties": {
          "type": "string"
        }
      }
    },
    "required": [
      "study_state"
    ]
  },
  "shield-study-addon-data": {
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "title": "Shield-Study-Addon 'data' field.",
    "description": "Shield-Study-addon addon-specific data, sent as Map(s,s).  You may have to cast back at re:dash.",
    "properties": {
      "attributes": {
        "type": "object",
        "description": "Map(string, string) of attributes of the addon data.",
        "properties": {},
        "additionalProperties": {
          "type": "string"
        }
      }
    }
  },
  "shield-study-error-data": {
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "title": "Shield-Study-Error 'data' field",
    "description": "Notify, group and count some kinds of errors from shield studies.",
    "properties": {
      "error_id": {
        "type": "string",
        "minLength": 1,
        "description": "Short name for an error, for easy counting."
      },
      "error_source": {
        "type": "string",
        "minLength": 1,
        "description": "Where did the error originate.",
        "enum": [
          "addon",
          "shield",
          "firefox",
          "unknown"
        ]
      },
      "message": {
        "type": "string",
        "minLength": 1,
        "title": "Message schema.",
        "description": "String of an error message."
      },
      "severity": {
        "type": "string",
        "minLength": 1,
        "description": "An explanation about the purpose of this instance.",
        "enum": [
          "debug",
          "info",
          "warn",
          "fatal",
          "impossible"
        ]
      },
      "attributes": {
        "type": "object",
        "description": "Additional Groupable Fields, sent as Map(String, String).",
        "properties": {},
        "additionalProperties":  {
          "type": "string"
        }
      },
      "error": {
        "type": "object",
        "description": "(Future use), things like tracebacks.",
        "properties": {},
        "additionalProperties":  {
          "type": "string"
        }
      }
    },
    "required": [
      "error_id",
      "error_source"
    ]
  }
}
